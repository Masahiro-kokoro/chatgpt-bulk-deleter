# テストガイド

このドキュメントでは、Bulk Chat & Memory Deleter の機能テスト手順を説明します。

---

## 🧪 テスト環境

### 必須
- Google Chrome 最新版
- ChatGPT アカウント（https://chatgpt.com/）
- テスト用の会話履歴（5件以上推奨）
- テスト用のメモリ（3件以上推奨）

### 推奨
- 複数のブラウザプロファイル（本番データと分離）
- テスト用のChatGPTアカウント

---

## ✅ 機能テスト

### 1. インストール直後の状態

#### テスト項目
- [◯] 選択モードがOFFであること
- [◯] チェックボックスが表示されていないこと
- [◯] 操作バーが表示されていないこと
- [◯] ChatGPTの通常機能に影響がないこと

#### 手順
1. 拡張機能をインストール
2. https://chatgpt.com/ を開く
3. 左サイドバーを確認
4. トグルボタンが「OFF」になっていることを確認
5. 会話履歴にチェックボックスがないことを確認

#### 期待結果
- トグルボタンのみが表示され、他のUI変更はない

---

### 2. 選択モードのトグル

#### テスト項目
- [◯] トグルボタンをクリックするとONになる
- [×] ONにするとチェックボックスが表示される
- [◯] 再度クリックするとOFFに戻る
- [×] OFFにするとチェックボックスが消える

#### 手順
1. トグルボタンをクリック
2. ボタンの表示が「ON」に変わることを確認
3. 各会話にチェックボックスが表示されることを確認
4. 再度トグルボタンをクリック
5. ボタンの表示が「OFF」に変わることを確認
6. チェックボックスが消えることを確認

#### 期待結果
- トグル操作が正常に動作し、状態が保存される

---

### 3. 会話履歴の選択

#### テスト項目
- [ ] チェックボックスをクリックすると選択状態になる
- [ ] 「全選択」ボタンですべてが選択される
- [ ] 「全解除」ボタンですべての選択が解除される
- [ ] 選択件数が正しく表示される

#### 手順
1. 選択モードをONにする
2. 1つのチェックボックスをクリック
3. 選択件数が「選択: 1」になることを確認
4. 「全選択」ボタンをクリック
5. すべてのチェックボックスがチェックされることを確認
6. 選択件数が正しいことを確認（例: 「選択: 12」）
7. 「全解除」ボタンをクリック
8. すべてのチェックボックスが解除されることを確認

#### 期待結果
- 選択・解除が正常に動作し、件数が正確に表示される

---

### 4. 削除ボタンの有効/無効

#### テスト項目
- [ ] 何も選択していない時は削除ボタンが無効
- [ ] 1件以上選択すると削除ボタンが有効

#### 手順
1. すべてのチェックボックスを解除
2. 削除ボタンが無効（グレーアウト）になることを確認
3. 1件選択
4. 削除ボタンが有効（赤色）になることを確認

#### 期待結果
- 選択件数に応じて削除ボタンの状態が変わる

---

### 5. 削除の確認ダイアログ

#### テスト項目
- [ ] 削除ボタンをクリックすると確認ダイアログが表示される
- [ ] ダイアログに選択件数が表示される
- [ ] 警告文（「この操作は取り消せません」）が表示される
- [ ] 「キャンセル」で削除されない
- [ ] 「削除する」で削除が実行される

#### 手順
1. 2〜3件の会話を選択
2. 削除ボタンをクリック
3. 確認ダイアログが表示されることを確認
4. 選択件数が正しいことを確認
5. 警告文が表示されることを確認
6. 「キャンセル」をクリック
7. ダイアログが閉じ、削除されていないことを確認
8. 再度削除ボタンをクリック
9. 「削除する」をクリック
10. 削除が開始されることを確認

#### 期待結果
- 確認ダイアログが正しく機能し、誤削除を防げる

---

### 6. 削除の進捗表示

#### テスト項目
- [ ] 削除中に進捗が表示される（例: 「3 / 12」）
- [ ] 中断ボタンが表示される
- [ ] 削除が逐次実行される（一度に複数削除されない）
- [ ] 各削除の間にディレイがある

#### 手順
1. 5件以上の会話を選択
2. 削除を実行
3. 進捗表示が「1 / 5」から始まることを確認
4. 数値が増えていくことを確認
5. 各削除の間に0.3〜0.5秒のディレイがあることを確認
6. 中断ボタンが表示されることを確認

#### 期待結果
- 削除の進捗が視覚的に分かり、各削除が逐次実行される

---

### 7. 削除の中断

#### テスト項目
- [ ] 中断ボタンをクリックすると削除が停止する
- [ ] 中断時点での削除件数が表示される

#### 手順
1. 10件以上の会話を選択
2. 削除を実行
3. 進捗が「3 / 10」くらいになったら「中断」ボタンをクリック
4. 削除が停止することを確認
5. トースト通知に「削除を中断しました（3件削除、0件失敗）」等が表示されることを確認

#### 期待結果
- 削除がいつでも中断でき、部分的な削除結果が通知される

---

### 8. 削除完了の通知

#### テスト項目
- [ ] 削除完了時にトースト通知が表示される
- [ ] 成功件数が表示される
- [ ] 失敗件数が表示される（失敗がある場合）

#### 手順
1. 3件の会話を選択
2. 削除を実行
3. 完了後にトースト通知が表示されることを確認
4. 「3件の会話を削除しました」と表示されることを確認

#### 期待結果
- 削除結果が明確に通知される

---

### 9. メモリの削除

#### テスト項目
- [ ] メモリ設定ページで注意文が表示される
- [ ] チェックボックスでメモリを選択できる
- [ ] 削除が正常に実行される

#### 手順
1. 設定 > パーソナライズ > メモリに移動
2. 注意文（「メモリはチャット履歴とは別に...」）が表示されることを確認
3. 選択モードをONにする
4. 各メモリにチェックボックスが表示されることを確認
5. 2〜3件を選択
6. 削除を実行
7. 確認ダイアログで「削除する」をクリック
8. 削除が実行されることを確認

#### 期待結果
- メモリの削除が会話履歴と同様に機能する

---

### 10. 状態の永続化

#### テスト項目
- [ ] 選択モードONの状態でページをリロードしてもONのまま
- [ ] 選択モードOFFの状態でページをリロードしてもOFFのまま

#### 手順
1. 選択モードをONにする
2. ページをリロード（F5）
3. トグルボタンが「ON」のままであることを確認
4. チェックボックスが表示されていることを確認
5. 選択モードをOFFにする
6. ページをリロード（F5）
7. トグルボタンが「OFF」のままであることを確認

#### 期待結果
- 選択モードの状態がchrome.storageに保存され、永続化される

---

### 11. URL変化の検知

#### テスト項目
- [ ] 別のページに移動してもトグルボタンが表示される
- [ ] メモリ設定ページに移動するとメモリ用UIが表示される
- [ ] メモリ設定ページから離れるとメモリ用UIが消える

#### 手順
1. chatgpt.com のトップページでトグルボタンが表示されることを確認
2. 新しい会話を開始
3. トグルボタンが引き続き表示されることを確認
4. 設定 > パーソナライズ > メモリに移動
5. 注意文とメモリ用のUIが表示されることを確認
6. トップページに戻る
7. 注意文とメモリ用のUIが消えることを確認

#### 期待結果
- SPAのURL変化を正しく検知し、適切なUIを表示する

---

## 🔍 エッジケースのテスト

### 1. 会話がゼロ件の場合
- [ ] トグルボタンは表示される
- [ ] 操作バーは表示される
- [ ] 選択件数は「0」
- [ ] 削除ボタンは無効

### 2. 会話が1件のみの場合
- [ ] 正常に選択・削除できる

### 3. 大量の会話（100件以上）
- [ ] パフォーマンスが低下しない
- [ ] チェックボックスがすべて表示される
- [ ] 削除が正常に実行される

### 4. ネットワークが遅い環境
- [ ] 削除ボタンのクリックで確認ダイアログが消えない場合、適切にタイムアウト

### 5. 同時に複数タブで開いている場合
- [ ] 選択モードの状態が全タブで同期される

---

## 🐛 バグチェック

### コンソールエラー
- [ ] DevToolsのConsoleにエラーが出ていないこと
- [ ] 会話内容やメモリ本文がログに出力されていないこと

### メモリリーク
- [ ] 長時間使用してもメモリ使用量が増え続けないこと

### パフォーマンス
- [ ] 選択モードON/OFFの切り替えが即座に反応すること
- [ ] チェックボックスの選択が遅延しないこと

### 視覚的な問題
- [ ] チェックボックスが既存のUIと重ならないこと
- [ ] ボタンが見切れていないこと
- [ ] テキストが読みやすいこと

---

## 📊 テスト記録テンプレート

```markdown
## テスト実施日: 2026年XX月XX日

### 環境
- OS: macOS / Windows / Linux
- Chrome バージョン: XXX.X.XXXX.XX
- 拡張機能バージョン: 1.0.0

### テスト結果

| # | テスト項目 | 結果 | 備考 |
|---|----------|------|------|
| 1 | インストール直後の状態 | ✅ |  |
| 2 | 選択モードのトグル | ✅ |  |
| 3 | 会話履歴の選択 | ✅ |  |
| 4 | 削除ボタンの有効/無効 | ✅ |  |
| 5 | 削除の確認ダイアログ | ✅ |  |
| 6 | 削除の進捗表示 | ✅ |  |
| 7 | 削除の中断 | ✅ |  |
| 8 | 削除完了の通知 | ✅ |  |
| 9 | メモリの削除 | ✅ |  |
| 10 | 状態の永続化 | ✅ |  |
| 11 | URL変化の検知 | ✅ |  |

### 発見したバグ
- なし

### 改善提案
- なし
```

---

以上
