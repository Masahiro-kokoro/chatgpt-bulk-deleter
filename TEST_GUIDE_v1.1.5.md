# テストガイド - v1.1.5

このガイドでは、v1.1.5の変更点のテスト手順を説明します。

---

## 🎯 テスト対象機能

### 主な変更点
1. **削除ボタンの反応速度改善**（即座に確認ダイアログ表示）
2. **進捗表示の改善**（ドットアニメーション）
3. **完了メッセージの改善**（リロード案内追加）

---

## 📋 事前準備

### 必要なもの
- Chrome ブラウザ
- ChatGPTアカウント
- 拡張機能のビルド済みファイル（`dist/`フォルダ）

### セットアップ
1. Chrome拡張機能ページを開く: `chrome://extensions/`
2. 「デベロッパーモード」を有効化
3. 「パッケージ化されていない拡張機能を読み込む」をクリック
4. `dist/`フォルダを選択

---

## ✅ テストケース

### テスト1: 削除ボタンの反応速度

**目的**: 削除ボタンをクリックすると即座に確認ダイアログが表示されることを確認

**手順**:
1. ChatGPT（https://chatgpt.com）を開く
2. 拡張機能のポップアップを開く
3. チャット履歴が表示されることを確認
4. 3件のチャット履歴を選択
5. **「削除」ボタンをクリック**
6. **タイマーで測定**: ボタンクリックから確認ダイアログが表示されるまでの時間

**期待される結果**:
- ✅ **即座に確認ダイアログが表示される**（0.1秒以内）
- ✅ 「最新データを確認中...」のローディング表示が**表示されない**
- ✅ 確認ダイアログの内容: 「3件のチャット履歴を削除します...」

**所要時間**: 約10秒

**比較（v1.1.4）**:
- v1.1.4: 0.5秒待機 → 確認ダイアログ
- v1.1.5: **即座に確認ダイアログ** ← テスト対象

---

### テスト2: ドットアニメーション

**目的**: 削除中に「削除中...」のドットがアニメーションすることを確認

**手順**:
1. ChatGPT（https://chatgpt.com）を開く
2. 拡張機能のポップアップを開く
3. 10件のチャット履歴を選択
4. 「削除」ボタンをクリック
5. 確認ダイアログで「OK」をクリック
6. **進捗表示を観察**

**期待される結果**:
- ✅ 「削除中」と表示される
- ✅ ドットがアニメーション: ` ` → `.` → `..` → `...` → ` ` （繰り返し）
- ✅ アニメーションサイクル: 約1.5秒
- ✅ 件数表示（例: 30/50）が**表示されない**

**所要時間**: 約30秒

**アニメーション詳細**:
```
0.0秒: 削除中
0.3秒: 削除中.
0.6秒: 削除中..
0.9秒: 削除中...
1.2秒: 削除中
1.5秒: 削除中.
（繰り返し）
```

---

### テスト3: 完了メッセージ（成功時）

**目的**: 削除完了後、リロード案内が表示されることを確認

**手順**:
1. ChatGPT（https://chatgpt.com）を開く
2. 拡張機能のポップアップを開く
3. 5件のチャット履歴を選択
4. 「削除」ボタンをクリック
5. 確認ダイアログで「OK」をクリック
6. 削除完了まで待機
7. **表示されるメッセージを確認**

**期待される結果**:
- ✅ 以下のメッセージが表示される:
```
✅ 5件のチャット履歴を削除しました。

ℹ️ ChatGPTサイドバーに反映するには、
ページをリロード（F5キー）してください。
```

**所要時間**: 約20秒

---

### テスト4: 完了メッセージ（エラー時）

**目的**: 一部削除失敗時もリロード案内が表示されることを確認

**準備**:
- このテストは自然に失敗を再現するのが難しいため、**スキップ可能**です
- または、削除中にネットワークを一時的に切断して失敗を発生させます

**手順**:
1. ChatGPT（https://chatgpt.com）を開く
2. 拡張機能のポップアップを開く
3. 10件のチャット履歴を選択
4. 「削除」ボタンをクリック
5. 確認ダイアログで「OK」をクリック
6. **削除中にネットワークを切断**（Wi-Fiをオフ）
7. 数秒後にネットワークを再接続
8. 削除完了まで待機
9. **表示されるメッセージを確認**

**期待される結果**:
- ✅ 以下のようなメッセージが表示される:
```
削除完了: 8件
失敗: 2件

一部のアイテムの削除に失敗しました。

ℹ️ ChatGPTサイドバーに反映するには、
ページをリロード（F5キー）してください。
```

**所要時間**: 約1分（スキップ可能）

---

### テスト5: ChatGPTサイドバーへの反映

**目的**: リロード後、ChatGPTサイドバーに削除が反映されることを確認

**手順**:
1. ChatGPT（https://chatgpt.com）を開く
2. ChatGPTサイドバーのチャット履歴数を確認（例: 50件）
3. 拡張機能のポップアップを開く
4. 5件のチャット履歴を選択
5. 「削除」ボタンをクリック → 確認 → 削除完了
6. 完了メッセージで「OK」をクリック
7. **F5キーを押してページをリロード**
8. ChatGPTサイドバーのチャット履歴数を確認

**期待される結果**:
- ✅ リロード前: 50件
- ✅ リロード後: 45件（5件削除されている）
- ✅ 削除したチャット履歴がサイドバーから消えている

**所要時間**: 約30秒

---

### テスト6: メモリタブでの動作

**目的**: チャットタブと同様に動作することを確認

**手順**:
1. ChatGPT（https://chatgpt.com）を開く
2. 拡張機能のポップアップを開く
3. **「メモリ」タブをクリック**
4. メモリが表示されることを確認（メモリがない場合はスキップ）
5. 3件のメモリを選択
6. 「削除」ボタンをクリック
7. **即座に確認ダイアログが表示されることを確認**
8. 「OK」をクリック
9. **「削除中...」のドットアニメーションを確認**
10. 削除完了後、**リロード案内が表示されることを確認**

**期待される結果**:
- ✅ チャットタブと同じ挙動
- ✅ 即座に確認ダイアログ
- ✅ ドットアニメーション
- ✅ リロード案内

**所要時間**: 約30秒

---

### テスト7: 複数回の削除

**目的**: 2回目以降の削除でも正常に動作することを確認

**手順**:
1. ChatGPT（https://chatgpt.com）を開く
2. 拡張機能のポップアップを開く
3. 3件のチャット履歴を選択
4. 「削除」ボタンをクリック → 確認 → 削除完了
5. 完了メッセージで「OK」をクリック
6. **再度、別の3件を選択**
7. 「削除」ボタンをクリック
8. **進捗表示を確認**

**期待される結果**:
- ✅ 1回目: 「削除中...」と表示される
- ✅ 2回目: **「削除中...」と表示される**（前回の件数が残っていない）
- ✅ ドットアニメーションが正常に動作

**所要時間**: 約40秒

**注**: v1.1.4では「削除中: 3 / 3」のような前回の件数が残る問題がありました。v1.1.5では修正されています。

---

### テスト8: 大量削除（50件）

**目的**: 50件削除時でもスムーズに動作することを確認

**手順**:
1. ChatGPT（https://chatgpt.com）を開く
2. 拡張機能のポップアップを開く
3. **全選択**ボタンをクリック（50件選択）
4. **時間測定開始**
5. 「削除」ボタンをクリック
6. 確認ダイアログで「OK」をクリック
7. 削除完了まで待機
8. **時間測定終了**

**期待される結果**:
- ✅ 削除開始までの時間: **0.1秒以内**（即座）
- ✅ 削除処理時間: 約40秒
- ✅ 合計時間: 約40秒
- ✅ ドットアニメーションがスムーズ
- ✅ リロード案内が表示される

**所要時間**: 約50秒

**比較（v1.1.4）**:
- v1.1.4: 約41秒（削除開始まで0.5秒待機）
- v1.1.5: 約40秒（即座に開始） ← **0.5秒高速化**

---

## 📊 パフォーマンステスト

### テスト9: 削除速度の測定

**目的**: v1.1.4との速度比較

**手順**:
1. ChatGPT（https://chatgpt.com）を開く
2. 拡張機能のポップアップを開く
3. 30件のチャット履歴を選択
4. **ストップウォッチで測定**:
   - 測定開始: 「削除」ボタンをクリック
   - 測定終了: 削除完了メッセージが表示される
5. 時間を記録

**期待される結果**:
- ✅ 削除時間: 約24秒（30件 × 0.8秒）
- ✅ v1.1.4より約0.5秒高速

**所要時間**: 約30秒

---

## 🔍 詳細確認

### コンソールログの確認

Chromeデベロッパーツールのコンソールで以下のログを確認:

**削除開始時**:
```
✅ Token cache cleared, will be refreshed on next request
```

**削除中**:
```
（10件ごとに）
🔄 トークンを再取得中...
```

**削除完了時**:
```
（エラーがあった場合）
❌ Failed to delete xxx after retries: ...
```

**注意**: 以下のログは**表示されない**はずです（v1.1.4で削除）:
```
🔄 最新データを確認中...
✅ 有効なID: xx件, 無効なID: xx件
```

---

## ✅ テスト完了チェックリスト

すべてのテストケースを実行して、以下を確認してください:

- [ ] **テスト1**: 削除ボタンの反応速度（即座に確認ダイアログ）
- [ ] **テスト2**: ドットアニメーション
- [ ] **テスト3**: 完了メッセージ（成功時）
- [ ] **テスト4**: 完了メッセージ（エラー時）※スキップ可能
- [ ] **テスト5**: ChatGPTサイドバーへの反映
- [ ] **テスト6**: メモリタブでの動作
- [ ] **テスト7**: 複数回の削除
- [ ] **テスト8**: 大量削除（50件）
- [ ] **テスト9**: 削除速度の測定

---

## 🐛 問題が発生した場合

### デバッグ手順

1. Chromeデベロッパーツールを開く（F12）
2. **Console**タブでエラーログを確認
3. **Network**タブでAPIリクエストを確認
4. 問題の詳細をGitHub Issuesに報告

### よくある問題

#### 問題1: ドットアニメーションが動かない

**原因**: CSSが正しく読み込まれていない

**解決**:
```bash
npm run build
```

#### 問題2: 完了メッセージにリロード案内が表示されない

**原因**: 古いバージョンが読み込まれている

**解決**:
1. Chrome拡張機能ページで拡張機能を削除
2. ブラウザを再起動
3. 再度読み込む

#### 問題3: 削除ボタンクリック後に「最新データを確認中...」が表示される

**原因**: v1.1.4が読み込まれている

**解決**: manifest.jsonのバージョンを確認（1.1.5であることを確認）

---

## 📝 テスト結果の記録

テスト実行後、以下の情報を記録してください:

```
テスト日時: 2026/02/06
ブラウザ: Chrome 121.0.0.0
OS: macOS 14.0

テスト1: ✅ 成功（0.05秒で確認ダイアログ表示）
テスト2: ✅ 成功（ドットアニメーション正常）
テスト3: ✅ 成功（リロード案内表示）
テスト4: ⏭️ スキップ
テスト5: ✅ 成功（リロード後反映確認）
テスト6: ✅ 成功（メモリタブでも正常動作）
テスト7: ✅ 成功（2回目も正常動作）
テスト8: ✅ 成功（50件を40秒で削除）
テスト9: ✅ 成功（30件を24秒で削除）

備考:
- 全てのテストケースが正常に動作
- v1.1.4より0.5秒高速化を確認
- ドットアニメーションが視覚的に分かりやすい
- リロード案内で混乱が解消
```

---

## 🎉 v1.1.4との比較

| 項目 | v1.1.4 | v1.1.5 | 評価 |
|------|--------|--------|------|
| **削除ボタンの反応** | 0.5秒待機 | 即座 | ✅ 改善 |
| **進捗表示** | 30/50 | 削除中... | ✅ シンプル |
| **ドットアニメーション** | なし | あり | ✅ 追加 |
| **リロード案内** | なし | あり | ✅ 追加 |
| **削除時間（50件）** | 41秒 | 40秒 | ✅ 高速化 |

**総合評価**: ✅ **v1.1.4より大幅に改善**

---

**テストにご協力いただきありがとうございます！ 🎉**
