# テストガイド - v1.1.6

このガイドでは、v1.1.6の新機能（Content Scriptの自動注入）のテスト手順を説明します。

---

## 🎯 テスト対象機能

### 主な新機能
1. **Content Scriptの自動注入**
   - Content Scriptが未ロード時に自動的に注入
   - エラーが発生しない
   - ページリロード不要

---

## 📋 事前準備

### 必要なもの
- Chrome ブラウザ
- ChatGPTアカウント
- v1.1.6のzipファイル

---

## ✅ 必須テストケース

### テスト1: Content Script未ロード時の自動修復（最重要）

**目的**: 拡張機能をインストール後、リロードせずに動作することを確認

**手順**:
1. 既存の拡張機能を削除
   ```
   chrome://extensions/
   → 拡張機能の「削除」をクリック
   ```

2. **ChatGPTを開く**
   ```
   https://chatgpt.com を新しいタブで開く
   ```

3. **リロードせずに拡張機能をインストール**
   ```
   chrome://extensions/
   → 「パッケージ化されていない拡張機能を読み込む」
   → chatgpt-bulk-deleter-v1.1.6/ フォルダを選択
   ```

4. **リロードせずにポップアップを開く**
   ```
   拡張機能アイコンをクリック
   ```

5. **結果を確認**

**期待される結果**:
- ✅ エラーが表示されない（v1.1.5ではエラーが出ていた）
- ✅ 約0.6秒後にチャット履歴が表示される
- ✅ 通常通り動作する

**コンソールログ（F12 → Console）**:
```
⚠️ Content Script not loaded, injecting...
✅ Content Script injected successfully
📡 Fetching conversations (max 50)...
✅ Conversations loaded: 50
```

**所要時間**: 約2分

**重要度**: ⭐⭐⭐⭐⭐（最重要）

---

### テスト2: 通常ケース（Content Scriptロード済み）

**目的**: リロード後は通常通り動作することを確認

**手順**:
1. ChatGPT（https://chatgpt.com）を開く
2. **F5でリロード**
3. 拡張機能のポップアップを開く
4. チャット履歴が表示される

**期待される結果**:
- ✅ 通常通り動作
- ✅ エラーなし
- ✅ 表示速度は変わらず

**コンソールログ**:
```
✅ Content Script is already loaded
📡 Fetching conversations (max 50)...
✅ Conversations loaded: 50
```

**所要時間**: 約30秒

---

### テスト3: 複数回のポップアップ開閉

**目的**: 2回目以降も高速に動作することを確認

**手順**:
1. ChatGPTを開く
2. ポップアップを開く（1回目）
3. ポップアップを閉じる
4. ポップアップを開く（2回目）
5. ポップアップを閉じる
6. ポップアップを開く（3回目）

**期待される結果**:
- ✅ 1回目: Content Scriptを注入（約0.6秒）
- ✅ 2回目以降: 即座に表示（約0.5秒）

**所要時間**: 約1分

---

### テスト4: メモリ削除の動作確認

**目的**: v1.1.5のメモリ削除バグが修正されていることを確認

**手順**:
1. ChatGPTを開く
2. ポップアップを開く
3. 「メモリ」タブをクリック
4. 1件のメモリを選択
5. 「削除」ボタンをクリック
6. 削除完了を待つ
7. **F5でリロード**
8. **ChatGPTの設定 → パーソナライズ → メモリを確認**

**期待される結果**:
- ✅ メモリが実際に削除されている

**所要時間**: 約1分

---

### テスト5: エラーメッセージの確認（オプション）

**目的**: 動的注入も失敗した場合のエラーメッセージを確認

**手順**:
このテストは通常失敗しないため、**スキップ可能**です。

---

## 📊 v1.1.5との比較テスト

### テストA: Content Script未ロード時の時間測定

**v1.1.5での挙動**:
```
ポップアップを開く
  ↓
エラーが表示される（約7秒後）
  ↓
ユーザーがF5でリロード
  ↓
もう一度ポップアップを開く

合計: 約10-15秒
```

**v1.1.6での挙動**:
```
ポップアップを開く
  ↓
自動修復（約0.6秒）
  ↓
チャット履歴が表示される

合計: 約0.6秒
```

**測定方法**:
1. 拡張機能を削除
2. ChatGPTを開く
3. 拡張機能を再インストール
4. **ストップウォッチで測定開始**
5. ポップアップを開く
6. チャット履歴が表示されるまでの時間を測定

**期待される結果**:
- ✅ 約0.6秒でチャット履歴が表示される
- ✅ v1.1.5より約10-15秒高速

---

## 🐛 問題が発生した場合

### よくある問題

#### 問題1: それでもエラーが表示される

**原因**: Content Scriptの動的注入に失敗

**解決策**:
1. ChatGPTのページで「F5」キーを押す
2. もう一度ポップアップを開く

#### 問題2: チャット履歴が表示されない

**原因**: APIリクエストが失敗している

**解決策**:
1. F12でConsoleタブを確認
2. エラーメッセージを確認
3. 報告する

---

## ✅ テスト完了チェックリスト

すべてのテストケースを実行して、以下を確認してください:

- [ ] **テスト1**: Content Script未ロード時の自動修復（最重要）
- [ ] **テスト2**: 通常ケース（Content Scriptロード済み）
- [ ] **テスト3**: 複数回のポップアップ開閉
- [ ] **テスト4**: メモリ削除の動作確認
- [ ] **テストA**: v1.1.5との時間比較

---

## 📝 テスト結果の記録

テスト実行後、以下の情報を記録してください:

```
テスト日時: 2026/02/06

✅ テスト1: Content Script未ロード時
   - エラーが表示されない: [はい/いいえ]
   - 表示時間: [秒]
   - コンソールログに「injecting」が表示: [はい/いいえ]

✅ テスト2: 通常ケース
   - 通常通り動作: [はい/いいえ]
   - 表示時間: [秒]

✅ テスト3: 複数回開閉
   - 1回目: [秒]
   - 2回目: [秒]
   - 3回目: [秒]

✅ テスト4: メモリ削除
   - 実際に削除された: [はい/いいえ]

総合評価: [良好/問題あり]

備考:
[何かあればここに記入]
```

---

**テストにご協力いただきありがとうございます！ 🎉**
