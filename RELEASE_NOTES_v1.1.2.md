# v1.1.2 - Stability Improvements

## 🎯 v1.1.2 - 安定性の大幅向上

### 主な変更点

#### 最大50件制限の導入
```
表示・削除件数: 最大50件
理由: 安定性とパフォーマンスの最適化
```

---

## ✨ 新機能

### 1. 最大50件制限
- 一度に表示・削除できる件数を50件に制限
- 50件を超える選択時にエラーメッセージを表示
- 大量削除時は複数回に分けて実行

### 2. トークン自動再取得
- 削除開始時にトークンキャッシュを自動クリア
- トークン期限切れによる失敗を防止

### 3. 削除後の自動更新
- 削除完了後に最新データを自動再ロード
- 常に最新の状態を表示

---

## 🐛 バグ修正

### 1. 削除失敗時の状態不整合
**問題**: 削除失敗後、`selectedIds` に古いIDが残り、再実行時に全て失敗

**修正**: 削除失敗時も `selectedIds` から削除するように変更

### 2. ポップアップ再表示時の数が合わない
**問題**: ポップアップを閉じて再度開くと、選択件数とチャット履歴の数が合わない

**修正**: 初期化時に `selectedIds` を自動クリア

### 3. エラー後の状態が残る
**問題**: エラー発生後、UIとデータの同期が取れない

**修正**: 削除後に最新データを自動再ロード

---

## ⚡ パフォーマンス改善

| 項目 | v1.1.1 | v1.1.2 | 改善 |
|------|--------|--------|------|
| **ロード速度** |
| チャット履歴（100件） | 1秒 | 0.5秒 | 2倍速 |
| チャット履歴（1000件） | 2-3秒 | 0.5秒 | **4-6倍速** |
| **削除速度** |
| 50件削除 | 20秒 | 40秒 | 2倍遅 |
| **成功率** |
| 削除成功率 | 74% | **95%+** | +21%+ |
| **安定性** |
| エラー後の回復 | 手動 | 自動 | ✅ |

---

## 📊 使用例

### シナリオ1: 50件以下の削除

```
1. ポップアップを開く（0.5秒）
2. 削除したいチャットを選択（30件）
3. 削除実行（約24秒）
4. 自動的に最新データを表示

合計時間: 約25秒
成功率: 95%+
```

### シナリオ2: 300件削除（6回に分けて実行）

```
1回目: 50件選択 → 削除（40秒）
2回目: 50件選択 → 削除（40秒）
3回目: 50件選択 → 削除（40秒）
4回目: 50件選択 → 削除（40秒）
5回目: 50件選択 → 削除（40秒）
6回目: 50件選択 → 削除（40秒）

合計時間: 約240秒（約4分）
成功率: ほぼ100%
```

---

## 🔧 技術的改善

### コードの簡素化
```
v1.1.1: 約150行（複雑な並列処理）
v1.1.2: 約80行（シンプルな1回取得）

削減: 約47%
```

### エラーハンドリングの改善
- selectedIds の一貫性を保証
- 削除後の自動リフレッシュ
- トークン期限切れの予防

---

## 📦 インストール方法

### Chrome拡張機能として手動インストール

1. [リリースページ](https://github.com/Masahiro-kokoro/chatgpt-bulk-deleter/releases/tag/v1.1.2)から `chatgpt-bulk-deleter-v1.1.2.zip` をダウンロード
2. ファイルを解凍
3. Chrome で `chrome://extensions/` を開く
4. 「デベロッパーモード」をONにする
5. 「パッケージ化されていない拡張機能を読み込む」をクリック
6. 解凍した `dist` フォルダを選択

### v1.1.1 からのアップグレード

1. 上記の手順で v1.1.2 をインストール
2. 既存の v1.1.1 は自動的に置き換えられます
3. データは保持されます

---

## ⚠️ 重要な注意事項

### 最大50件制限について

```
理由:
- レート制限の回避
- 削除成功率の向上（95%+）
- エラー後の回復性向上

大量削除時:
- 複数回に分けて実行が必要
- ただし、確実性が大幅に向上
```

### 削除は不可逆です
- 削除したデータは復元できません
- バックアップ・エクスポート機能はありません
- 削除実行前に必ず確認してください

---

## 📝 完全な変更履歴

詳細は [CHANGELOG.md](https://github.com/Masahiro-kokoro/chatgpt-bulk-deleter/blob/main/CHANGELOG.md) をご覧ください。

---

## 🔗 リンク

- [GitHub Repository](https://github.com/Masahiro-kokoro/chatgpt-bulk-deleter)
- [Issues](https://github.com/Masahiro-kokoro/chatgpt-bulk-deleter/issues)
- [README](https://github.com/Masahiro-kokoro/chatgpt-bulk-deleter/blob/main/README.md)
- [v1.1.1 リリース](https://github.com/Masahiro-kokoro/chatgpt-bulk-deleter/releases/tag/v1.1.1)
- [v1.1.0 リリース](https://github.com/Masahiro-kokoro/chatgpt-bulk-deleter/releases/tag/v1.1.0)
